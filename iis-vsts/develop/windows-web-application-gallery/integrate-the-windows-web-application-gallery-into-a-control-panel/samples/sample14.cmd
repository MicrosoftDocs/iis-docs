foreach (Product p in pm.Products) {
  if (!p.IsApplication) {
     continue;
  }
[...]