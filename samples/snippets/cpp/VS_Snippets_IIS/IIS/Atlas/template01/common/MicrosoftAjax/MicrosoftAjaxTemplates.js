//----------------------------------------------------------
// Copyright (C) Microsoft Corporation. All rights reserved.
//----------------------------------------------------------
// MicrosoftAjaxTemplates.js
Type._registerScript("MicrosoftAjaxTemplates.js",["MicrosoftAjaxComponentModel.js","MicrosoftAjaxSerialization.js"]);Type.registerNamespace("Sys.Net");Sys.Net.WebServiceOperation=function(a,b,c){if(typeof a==="undefined")a=null;this.operation=a;this.parameters=b||null;this.httpVerb=c||null};Sys.Net.WebServiceOperation.prototype={operation:null,parameters:null,httpVerb:null};Sys.Net.WebServiceOperation.registerClass("Sys.Net.WebServiceOperation");Sys.Net.WebRequestEventArgs=function(b,c,a){this._executor=b;this._error=c||null;this._result=typeof a==="undefined"?null:a;Sys.Net.WebRequestEventArgs.initializeBase(this)};Sys.Net.WebRequestEventArgs.prototype={get_error:function(){return this._error||null},get_executor:function(){return this._executor},get_result:function(){return this._result}};Sys.Net.WebRequestEventArgs.registerClass("Sys.Net.WebRequestEventArgs",Sys.EventArgs);Type.registerNamespace("Sys.Data");if(!Sys.Data.IDataProvider){Sys.Data.IDataProvider=function(){};Sys.Data.IDataProvider.prototype={fetchData:function(){}};Sys.Data.IDataProvider.registerInterface("Sys.Data.IDataProvider")}if(!Sys.Data.MergeOption){Sys.Data.MergeOption=function(){throw Error.notImplemented()};Sys.Data.MergeOption.prototype={appendOnly:0,overwriteChanges:1};Sys.Data.MergeOption.registerEnum("Sys.Data.MergeOption")}Sys.Data.DataContext=function(){Sys.Data.DataContext.initializeBase(this);this._dataChangedDel=Function.createDelegate(this,this._dataChanged);this._items={};this._methods={}};Sys.Data.DataContext.prototype={_useIdentity:false,_dirty:false,_lastResults:null,_items:null,_ignoreChange:false,_inserts:null,_edits:null,_deletes:null,_changelist:null,_hasChanges:false,_mergeOption:Sys.Data.MergeOption.overwriteChanges,_saverequest:null,_saving:false,_serviceUri:null,_saveOperation:null,_saveParameters:null,_saveHttpVerb:null,_saveTimeout:0,_methods:null,get_changes:function(){var a=this._changelist;if(!a)this._changelist=a=[];return a},get_createEntityMethod:function(){return this._methods.createEntity||null},set_createEntityMethod:function(a){this._methods.createEntity=a},get_getIdentityMethod:function(){return this._methods.getIdentity||null},set_getIdentityMethod:function(a){this._methods.getIdentity=a;this._useIdentity=!!a},get_handleSaveChangesResultsMethod:function(){return this._methods.handleSaveResults||null},set_handleSaveChangesResultsMethod:function(a){this._methods.handleSaveResults=a},get_isDeferredPropertyMethod:function(){return this._methods.isDeferredProperty||null},set_isDeferredPropertyMethod:function(a){this._methods.isDeferredProperty=a},get_getNewIdentityMethod:function(){return this._methods.getNewIdentity||null},set_getNewIdentityMethod:function(a){this._methods.getNewIdentity=a},get_getDeferredPropertyFetchOperationMethod:function(){return this._methods.getDeferredQuery||null},set_getDeferredPropertyFetchOperationMethod:function(a){this._methods.getDeferredQuery=a},get_items:function(){return this._items},get_lastFetchDataResults:function(){return this._lastResults||null},get_hasChanges:function(){return this._hasChanges},get_fetchDataMethod:function(){return this._methods.fetchData||null},set_fetchDataMethod:function(a){this._methods.fetchData=a},get_mergeOption:function(){return this._mergeOption},set_mergeOption:function(a){this._mergeOption=a},get_saveChangesMethod:function(){return this._methods.saveChanges||null},set_saveChangesMethod:function(a){this._methods.saveChanges=a},get_saveOperation:function(){return this._saveOperation||""},set_saveOperation:function(a){this._saveOperation=a},get_saveHttpVerb:function(){return this._saveHttpVerb||"POST"},set_saveHttpVerb:function(a){this._saveHttpVerb=a},get_saveParameters:function(){return this._saveParameters},set_saveParameters:function(a){this._saveParameters=a},get_saveChangesTimeout:function(){return this._saveTimeout},set_saveChangesTimeout:function(a){this._saveTimeout=a},get_isSaving:function(){return this._saving},get_serviceUri:function(){return this._serviceUri||""},set_serviceUri:function(a){this._serviceUri=a},addLink:function(c,b,d){var a=this._toggleLink(c,b,d),e=this._setLinkField(true,c,b,d);if(!a||a.action!==Sys.Data.ChangeOperationType.remove)if(e||a&&a.action===Sys.Data.ChangeOperationType.insert)this._registerChange(new Sys.Data.ChangeOperation(Sys.Data.ChangeOperationType.insert,null,c,b,d))},removeLink:function(c,b,d){var a=this._toggleLink(c,b,d),e=this._setLinkField(true,c,b,d,true);if(!a||a.action!==Sys.Data.ChangeOperationType.insert)if(e||a&&a.action===Sys.Data.ChangeOperationType.remove)this._registerChange(new Sys.Data.ChangeOperation(Sys.Data.ChangeOperationType.remove,null,c,b,d))},setLink:function(b,a,c){this._toggleLink(b,a,c);this._setLinkField(false,b,a,c);this._registerChange(new Sys.Data.ChangeOperation(Sys.Data.ChangeOperationType.update,null,b,a,c))},abortSave:function(){if(this._saverequest){this._saverequest.get_executor().abort();this._saverequest=null}if(this._saving){this._saving=false;this.raisePropertyChanged("isSaving")}},clearChanges:function(){this._edits=this._deletes=this._inserts=null;if(this._changelist)Sys.Observer.clear(this._changelist);if(this._hasChanges){this._hasChanges=false;this.raisePropertyChanged("hasChanges")}},clearData:function(){this._clearData()},createEntity:function(a){var b=this.get_createEntityMethod();return b(this,a)},dispose:function(){if(this._disposed)return;this._disposed=true;if(this.get_isSaving())this.abortSave();this.clearData();this._lastResults=null;this._saverequest=null;this._methods={};Sys.Data.DataContext.callBaseMethod(this,"dispose")},initialize:function(){this.updated();Sys.Data.DataContext.callBaseMethod(this,"initialize")},fetchDeferredProperty:function(g,c,d,e,f,h,a){var i=this.get_getDeferredPropertyFetchOperationMethod(),j=this,b=i(this,g,c,a);if(b&&b.operation){function k(b){j._setField(g,c,null,b,null,true);if(e)e(b,a,c)}function l(b){if(f)f(b,a,c)}if(typeof a==="undefined")a=null;if(typeof d==="undefined"||d===null)d=this.get_mergeOption();return this.fetchData(b.operation,b.parameters||null,d,b.httpVerb||"POST",k,l,h||0,a)}},getNewIdentity:function(c,b){var a=this.get_getNewIdentityMethod();return a?a(this,c,b)||null:null},insertEntity:function(b,c){var a=null;if(this._useIdentity){a=this.getIdentity(b);if(a===null)a=this.getNewIdentity(b,c||null);if(!a)throw Error.invalidOperation(Sys.UI.TemplatesRes.requiredIdentity);if(this._items[a])throw Error.invalidOperation(String.format(Sys.UI.TemplatesRes.entityAlreadyExists,a));this._storeEntity(a,b)}else this._captureEntity(b);this._inserts=this._pushChange(this._inserts,b,a);this._registerChange(new Sys.Data.ChangeOperation(Sys.Data.ChangeOperationType.insert,b))},removeEntity:function(a){if(this._ignoreChange)return;var b=this.getIdentity(a);if(b!==null){a=this._items[b];if(typeof a==="undefined")return;delete this._items[b]}this._releaseEntity(a);var f=this,c=this.get_changes(),e=this._hasChanges;function d(){for(var b=0,d=c.length;b<d;b++)if(c[b].item===a){Sys.Observer.removeAt(c,b);f._hasChanges=!!c.length;return}}if(this._peekChange(this._inserts,a,b,true))d();else{this._deletes=this._pushChange(this._deletes,a,b);if(this._peekChange(this._edits,a,b,true))d();Sys.Observer.add(c,new Sys.Data.ChangeOperation(Sys.Data.ChangeOperationType.remove,a));this._hasChanges=true}if(this._hasChanges!==e)this._raiseChanged("hasChanges")},fetchData:function(c,g,b,h,e,f,i,a){var d=this;if(typeof b==="undefined"||b===null)b=this.get_mergeOption();function j(g){if(d._disposed)return;var f=d.trackData(g,b);if(e){if(g instanceof Array&&f===g)f=Array.clone(f);e(f,a,c)}}function k(b){if(d._disposed)return;if(f)f(b,a,c)}if(typeof a==="undefined")a=null;return (this.get_fetchDataMethod()||Sys.Data.DataContext._fetchWSP)(this,this.get_serviceUri(),c,g||null,h||"POST",j,k,i||0,a)},_clearData:function(a){if(this._useIdentity)for(var b in this._items){var d=this._items[b];this._releaseEntity(d)}else if(this._lastResults)this._release(this._lastResults);this._items={};var c=this._lastResults;this._lastResults=a||null;this.clearChanges();if(a)this._capture(a);if(c!==null)this._raiseChanged("lastFetchDataResults")},_combineParameters:function(c,d){var a,b={};for(a in c)b[a]=c[a];for(a in d)b[a]=d[a];return b},_fixAfterSave:function(e,a,b){if(this._useIdentity){var d=this.getIdentity(a),c=this.getIdentity(b);this._combine(a,b);if(d!==c){delete this._items[d];this._items[c]=a}}else{this._combine(a,b);if(e.action===Sys.NotifyCollectionChangedAction.add)this._captureEntity(item)}},trackData:function(a,b){if(this._useIdentity){if(typeof b==="undefined"||b===null)b=this.get_mergeOption();var c;if(a instanceof Array)a=this._storeEntities(a,b);else if(typeof a!=="undefined"&&a!==null){c=this._storeEntities([a],b);if(c.length===0)a=null}var d=this._lastResults;this._lastResults=a;if(d!==null)this._raiseChanged("lastFetchDataResults")}else this._clearData(a);return a},_processResults:function(c,e,a){if(a&&a.length===e.length){c._ignoreChange=true;try{for(var b=0,h=a.length;b<h;b++){var d=a[b],f=e[b],g=f.item;if(d&&typeof d==="object")c._fixAfterSave(f,g,d)}}finally{c._ignoreChange=false}}},_peekChange:function(a,c,b,d){if(!a)return false;if(b!==null){var e="id$"+b,f=a[e];if(f){if(d)a[e]=null;return true}}else if(d)return Array.remove(a,c);else return Array.contains(a,c)},_pushChange:function(a,c,b){if(!a)a=[];if(b===null)a[a.length]=c;else a["id$"+b]=true;return a},_registerChange:function(a){Sys.Observer.add(this.get_changes(),a);if(!this._hasChanges){this._hasChanges=true;this.raisePropertyChanged("hasChanges")}},saveChanges:function(f,g,e){var b=false,k=this.get_serviceUri(),h=this.get_saveOperation(),a=this,c;function d(g){if(a._disposed)return;if(!b){b=true;window.setTimeout(function(){d(g)},0)}else{a.clearChanges();var i=a.get_handleSaveChangesResultsMethod();(i||a._processResults)(a,c,g);a._saverequest=null;a._saving=false;a._raiseChanged("isSaving");if(f)f(g,e,h)}}function i(c){if(a._disposed)return;if(!b){b=true;window.setTimeout(function(){i(c)},0)}else{a._saverequest=null;a._saving=false;a._raiseChanged("isSaving");if(g)g(c,e,h)}}if(!this._hasChanges){d(null);return null}c=Array.clone(this.get_changes());if(c.length===0){d(null);return null}if(!k)return;if(this.get_isSaving())this.abortSave();this._saving=true;this._raiseChanged("isSaving");var j=this._filterLinks(c);this._saverequest=(this.get_saveChangesMethod()||this._saveInternal)(this,j,d,i,e);b=true;return this._saverequest},_isDeleted:function(d){var b,e,a,c=this.get_changes(),f=this.getIdentity(d);for(b=0,e=c.length;b<e;b++){a=c[b];if(a.action===Sys.Data.ChangeOperationType.remove&&a.item&&(a.item===d||this.getIdentity(a.item)===f))return true}return false},_removeChanges:function(g,f){var b,e,c,a,d=this.get_changes();for(b=0,e=d.length;b<e;b++){a=d[b];if(f&&a.linkSource===g&&a.linkSourceField===f||!f&&a.item&&typeof a.item==="object"&&(a.item===g||this.getIdentity(a.item)===this.getIdentity(g)))if(!c)c=[a];else c[c.length]=a}if(c){Sys.Observer.beginUpdate(d);for(b=0,e=c.length;b<e;b++)Sys.Observer.remove(d,c[b]);Sys.Observer.endUpdate(d);if(d.length===0){this._hasChanges=false;this.raisePropertyChanged("hasChanges")}}},_setLinkField:function(f,b,c,e,d){if(f){var a=b[c];if(a===null||this._getValueType(b,c,a)!==2){if(d)return false;b[c]=a=[]}this._ignoreChange=true;try{if(Array.contains(a,e))if(d){Sys.Observer.remove(a,e);return true}else return false;else if(d)return false;else{Sys.Observer.add(a,e);return true}}finally{this._ignoreChange=false}}else{this._ignoreChange=true;try{if(d)Sys.Observer.setValue(b,c,null);else Sys.Observer.setValue(b,c,e);return true}finally{this._ignoreChange=false}}},_toggleLink:function(e,g,f){var a,b=this.get_changes();for(var c=0,h=b.length;c<h;c++){a=b[c];if(a.linkSourceField===g&&a.linkSource===e&&(a.linkTarget===f||a.action===Sys.Data.ChangeOperationType.update)){Sys.Observer.remove(b,a);var d=this._hasChanges;this._hasChanges=!!b.length;if(d!==this._hasChanges)this.raisePropertyChanged("hasChanges");return a}}return null},updated:function(){if(this._dirty){this._dirty=false;this.raisePropertyChanged("")}},_capture:function(a){if(a instanceof Array)for(var b=0,c=a.length;b<c;b++)this._captureEntity(a[b]);else if(a!==null)this._captureEntity(a)},_captureEntity:function(a){if(this._isCaptureable(a))Sys.Observer.addPropertyChanged(a,this._dataChangedDel)},_dataChanged:function(a){if(this._ignoreChange)return;var d=this.get_changes(),b=this.getIdentity(a);if(!this._peekChange(this._inserts,a,b)){var c=this._peekChange(this._edits,a,b);if(!c){Sys.Observer.add(d,new Sys.Data.ChangeOperation(Sys.Data.ChangeOperationType.update,a));this._edits=this._pushChange(this._edits,a,b);if(!this._hasChanges){this._hasChanges=true;this.raisePropertyChanged("hasChanges")}}}},_isActive:function(){return this.get_isInitialized()&&!this.get_isUpdating()},_isCaptureable:function(a){if(a===null)return false;var b=typeof a;return b==="object"||b==="unknown"},_raiseChanged:function(a){if(this._isActive()){this.raisePropertyChanged(a);return true}else{this._dirty=true;return false}},_release:function(a){if(a instanceof Array)for(var b=0,c=a.length;b<c;b++)this._releaseEntity(a[b]);else if(a!==null)this._releaseEntity(a)},_releaseEntity:function(a){if(this._isCaptureable(a))Sys.Observer.removePropertyChanged(a,this._dataChangedDel)},_saveInternal:function(a,c,d,e,f){var b=a.get_saveParameters();return Sys.Net.WebServiceProxy.invoke(a.get_serviceUri(),a.get_saveOperation()||"",a.get_saveHttpVerb()==="GET",b?a._combineParameters(b,{changeSet:c}):{changeSet:c},d,e,f,a.get_saveChangesTimeout()||0)},_filterLinks:function(f){if(!this._useIdentity)return f;var b,h=f.length,g=new Array(h);for(b=0;b<h;b++){var a=f[b],e=a.item,c=a.linkSource,d=a.linkTarget;if(e)e=this._getEntityOnly(e);if(c)c=this._getEntityOnly(c);if(d)d=this._getEntityOnly(d);g[b]=new Sys.Data.ChangeOperation(a.action,e,c,a.linkSourceField,d)}return g},_getEntityOnly:function(b){var a={};this._combine(a,b,null,true);return a},getIdentity:function(a){if(a===null)return null;var b=this.get_getIdentityMethod();return b?b(this,a)||null:null},isDeferredProperty:function(c,b){var a=this.get_isDeferredPropertyMethod();return a?a(this,c,b)||false:false},_getValueType:function(c,d,a){var b=typeof a;if(b==="undefined")return 0;if(a===null||b!=="object")return 2;if(this.isDeferredProperty(c,d))return 1;return 2},_setField:function(a,b,h,d,i,k){var c=true,g=a instanceof Array,e=i===Sys.Data.MergeOption.appendOnly;if(!g){var j=a[b],f=this._getValueType(a,b,j);if(e){if(f===2)c=false}else if(f===2&&d&&h&&this._getValueType(h,b,d)===1)c=false}if(c){if(g)a[b]=d;else{this._ignoreChange=true;try{Sys.Observer.setValue(a,b,d)}finally{this._ignoreChange=false}}if(k&&!e)this._removeChanges(a,b)}return c},_combine:function(b,e,c,h){var i=false;for(var d in e){var a=e[d],j=typeof a;if(j==="function")continue;if(this._useIdentity&&a instanceof Array){if(!h){a=this._storeEntities(a,c);if(b)this._setField(b,d,e,a,c,true)}}else{var g=null;if(a&&j==="object")g=this.getIdentity(a);if(g!==null){if(!h)this._storeEntity(g,a,b,d,e,c)}else if(b){var f=b[d];if(f&&typeof f==="object"&&this.getIdentity(f))continue;if(this._setField(b,d,e,a,c)&&!i&&(typeof c!=="number"||c===Sys.Data.MergeOption.overwriteChanges)){i=true;this._removeChanges(b)}}}}},_storeEntity:function(f,b,d,e,h,c){var g=true,a=this._items[f];if(typeof a!=="undefined")if(a===b)g=false;else this._combine(a,b,c);else{this._items[f]=a=b;this._captureEntity(b);this._combine(null,b,c)}if(d&&d[e]!==a)this._setField(d,e,h,a,c,true);return g},_storeEntities:function(d,g){var a,e,f,c,h=g===Sys.Data.MergeOption.appendOnly;for(a=0,e=d.length;a<e;a++){var b=d[a],j=b&&typeof b==="object";if(j){if(h)if(this._isDeleted(b)){if(!c)c=[b];else c[c.length]=b;continue}var i=this.getIdentity(b);if(i!==null)if(this._storeEntity(i,b,d,a,null,g)&&!h)this._removeChanges(b)}}if(c){f=Array.clone(d);for(a=0,e=c.length;a<e;a++)Array.remove(f,c[a])}return f||d}};Sys.Data.DataContext.registerClass("Sys.Data.DataContext",Sys.Component,Sys.Data.IDataProvider);Sys.Data.DataContext._fetchWSP=function(i,h,d,c,e,a,b,g,f){return Sys.Net.WebServiceProxy.invoke(h,d,e==="GET",c,a,b,f,g)};Sys.Data.DataEventArgs=function(a){this._data=a;Sys.Data.DataEventArgs.initializeBase(this)};Sys.Data.DataEventArgs.prototype={get_data:function(){var a=this._data;return typeof a==="undefined"?null:a},set_data:function(a){this._data=a}};Sys.Data.DataEventArgs.registerClass("Sys.Data.DataEventArgs",Sys.CancelEventArgs);Sys.Data.ChangeOperationType=function(){throw Error.notImplemented()};Sys.Data.ChangeOperationType.prototype={insert:0,update:1,remove:2};Sys.Data.ChangeOperationType.registerEnum("Sys.Data.ChangeOperationType");Sys.Data.ChangeOperation=function(d,e,b,a,c){this.action=d;this.item=e;this.linkSourceField=a;this.linkSource=b;this.linkTarget=c};Sys.Data.ChangeOperation.prototype={action:null,item:null,linkSource:null,linkSourceField:null,linkTarget:null};Sys.Data.ChangeOperation.registerClass("Sys.Data.ChangeOperation");Sys.Data.AdoNetDataContext=function(){Sys.Data.AdoNetDataContext.initializeBase(this);this.set_getIdentityMethod(this._getIdentity);this.set_getNewIdentityMethod(this._getNewIdentity);this.set_fetchDataMethod(this._fetchAdoNet);this.set_saveChangesMethod(this._saveAdoNet);this.set_createEntityMethod(this._createEntity);this.set_handleSaveChangesResultsMethod(this._processResultsAdoNet);this.set_getDeferredPropertyFetchOperationMethod(this._getDeferredQuery);this.set_isDeferredPropertyMethod(this._isDeferred)};Sys.Data.AdoNetDataContext.prototype={_proxy:null,_puri:null,_entityCounter:0,_saveCounter:1,_createEntity:function(c,b){var a={};c._createMetaData(a,b);return a},_fetchAdoNet:function(f,b,a,g,h,d,e,j,i){if(a){if(typeof a!=="string")a=a.toString();var c=a.indexOf(":");if(c!==-1&&c<a.indexOf("/"))b=a}var k=f._getProxy(b||"");return k.fetchData(a,g||null,null,h||null,d||null,e||null,j||0,i||null)},_getDeferredQuery:function(d,e,c){var a=null,b=e[c];if(b===null||typeof b==="undefined"||b instanceof Array){a=d.getIdentity(e);a+=a.endsWith("/")?c:"/"+c}else if(typeof b==="object"){a=d.getIdentity(b);if(!a)a=b.__deferred?b.__deferred.uri:null}if(!a)throw Error.invalidOperation(String.format(Sys.Data.AdoNetRes.propertyNotFound,c));return new Sys.Net.WebServiceOperation(a)},_getProxy:function(a){if(this._puri!==a){this._proxy=new Sys.Data.AdoNetServiceProxy(a);this._puri=a}return this._proxy},_isDeferred:function(d,c,b){var a=c[b];return !!(a&&typeof a==="object"&&a.__deferred)},_processResultsAdoNet:function(h,c,a){if(a&&a.length===c.length)for(i=0,l=a.length;i<l;i++){var e=c[i],b=e.item,f=a[i],g=f.get_result(),d=f.get_httpHeaders();if(b){if(g)h._fixAfterSave(e,b,g);if(d.ETag&&b.__metadata)b.__metadata.etag=d.ETag}}},_getBatchReference:function(c,e,d,f){var b=c.__metadata[e];if(typeof b==="number")return d+"$"+b;else{var a=this.getIdentity(c);if(f)a=a.substr(a.lastIndexOf("/"));return a}},_saveAdoNet:function(a,h,k,l,m){var f,j,n=a.get_serviceUri(),i=a._getProxy(n),d=i.createActionSequence(),c="__batchNumber"+a._saveCounter++;i.set_timeout(a.get_saveChangesTimeout());for(f=0,j=h.length;f<j;f++){var b=h[f],e=b.item;switch(b.action){case Sys.Data.ChangeOperationType.insert:if(e){var g=a.get_items()[a.getIdentity(e)];delete e.__metadata;g.__metadata[c]=f;d.addInsertAction(e,g.__metadata.entitySet)}else d.addInsertAction({uri:a._getBatchReference(b.linkTarget,c,"")},a._getBatchReference(b.linkSource,c,"/")+"/$links/"+b.linkSourceField);break;case Sys.Data.ChangeOperationType.update:if(e)d.addUpdateAction(e);else if(b.linkTarget)d.addUpdateAction({uri:a._getBatchReference(b.linkTarget,c,"")},a._getBatchReference(b.linkSource,c,"/")+"/$links/"+b.linkSourceField);else d.addRemoveAction({__metadata:{uri:a._getBatchReference(b.linkSource,c,"/")+"/$links/"+b.linkSourceField}});break;case Sys.Data.ChangeOperationType.remove:if(e)d.addRemoveAction(e);else d.addRemoveAction({__metadata:{uri:a._getBatchReference(b.linkSource,c,"/")+"/$links"+a._getBatchReference(b.linkTarget,c,"/",true)}})}}return d.execute(k,l,m)},_createMetaData:function(b,a){b.__metadata={entitySet:a,uri:a+"(__new"+this._entityCounter+++")"}},_getNewIdentity:function(c,a,b){c._createMetaData(a,b);return a.__metadata.uri},_getIdentity:function(c,b){var a=b.__metadata;if(a)return a.uri||null;return null}};Sys.Data.AdoNetDataContext.registerClass("Sys.Data.AdoNetDataContext",Sys.Data.DataContext);Type.registerNamespace("Sys.UI");Sys.UI.DomElement._oldGetElementById=Sys.UI.DomElement.getElementById;Sys.UI.DomElement.getElementById=function(c,h){var a=Sys.UI.DomElement._oldGetElementById(c,h);if(!a&&!h&&Sys.UI.Template._contexts.length){var f=Sys.UI.Template._contexts;for(var d=0,i=f.length;d<i;d++){var g=f[d];for(var e=0,j=g.length;e<j;e++){var b=g[e];if(b.nodeType===1){if(b.id===c)return b;a=Sys.UI.DomElement._oldGetElementById(c,b);if(a)return a}}}}return a};if($get===Sys.UI.DomElement._oldGetElementById)$get=Sys.UI.DomElement.getElementById;Sys.Application.registerMarkupExtension=function(b,c,a){if(!this._extensions)this._extensions={};a=typeof a==="undefined"||a===true;this._extensions[b]={expression:a,extension:c}};Sys.Application._getMarkupExtension=function(b){var a=this._extensions?this._extensions[b]:null;if(!a)throw Error.invalidOperation(String.format(Sys.UI.TemplatesRes.cannotFindMarkupExtension,b));return a};Sys.Application._caseIndex={};Sys.Application._prototypeIndex={};Sys.Application._indexOf=function(b,c){for(var a=0,d=b.length;a<d;a++)if(b[a]===c)return a;return -1};Sys.Application.activateElement=function(a,b,c){var d={userContext:b,localContext:{}};return Sys.Application._activateElementWithMappings(Sys.Application._getNamespaceMappings(null,[a]),null,null,a,d,c)};Sys.Application.activateElements=function(c,a,b){return Sys.Application._activateElements(c,null,null,a,b)};Sys.Application._activateElements=function(b,g,f,c,h){var a,e=[];c={userContext:c,localContext:{}};for(var d=0,i=b.length;d<i;d++){a=b[d];if(a.nodeType!==1)continue;Array.addRange(e,Sys.Application._activateElementWithMappings(f||Sys.Application._getNamespaceMappings(null,[a]),b,g,a,c,h));a.__msajaxactivated=true}return e};Sys.Application._activateElementWithMappings=function(i,n,j,e,o,l){var c,h,d=[],m=Sys.Browser.agent===Sys.Browser.InternetExplorer;if(!e.__msajaxactivated){Sys.Application._activateElementInternal(m,e,i,d,o);if(l||typeof l==="undefined")if(!Sys.UI.Template._isTemplate(e)){var g=e.getElementsByTagName("*");for(c=0,h=g.length;c<h;c++){var b=g[c],f=b.__msajaxactivated;if(!f)if(j){if(b.id&&Sys.Application._indexOf(j,b.id)!==-1)f=true}else if(n&&Sys.Application._indexOf(n,b)!==-1)f=true;if(!f)Sys.Application._activateElementInternal(m,b,i,d,o);if(f||Sys.UI.Template._isTemplate(b)){var a=b.nextSibling;while(a&&a.nodeType!==1)a=a.nextSibling;while(!a){b=b.parentNode;if(b===e)break;a=b.nextSibling;while(a&&a.nodeType!==1)a=a.nextSibling}if(!a||a.nodeType!==1)break;do{b=g[c+1];if(b===a)break;c++}while(c<h)}}}}for(c=d.length-1;c>-1;c--){var k=d[c];if(Sys.Component.isInstanceOfType(k))k.endUpdate()}return d};Sys.Application._activateElementInternal=function(e,a,d,B,g){var b,i,c,r=null,s=null;try{r=e?a[d.types]:a.getAttribute(d.types)}catch(C){}try{s=e?a[d.sysKey]:a.getAttribute(d.sysKey)}catch(C){}if(s)g.localContext[s]=a;if(r){a.__msajaxactivated=true;var v=r.split(","),q={},k=[];for(b=0,i=v.length;b<i;b++){var f=v[b].trim();if(q[f])continue;var h=d.namespaces[f],u=h.inheritsFrom(Sys.Component),t=u&&(h.inheritsFrom(Sys.UI.Behavior)||h.inheritsFrom(Sys.UI.Control));c=t?new h(a):new h;if(u){k.push(c);c.beginUpdate()}if(!t)Sys.Application._registerComponent(a,c);q[f]={instance:c,typeName:f,type:h};B.push(c);var o=null;try{o=e?a[f+":sys-key"]:a.getAttribute(f+":sys-key")}catch(C){}if(o)g.localContext[o]=c}for(b=0,i=a.attributes.length;b<i;b++){var l=a.attributes[b];if(!l.specified)continue;var m=l.nodeName;if(m===d.sysKey||m===d.types)continue;var n=Sys.Application._splitAttribute(m),x=n.ns;if(!x)continue;var p=q[x];if(!p)continue;if(n.name!=="sys-key")Sys.Application._setProperty(p.instance,p.type,n.name,l.nodeValue,g)}var j=Sys.Application,y=j.get_isCreatingComponents();for(b=0,i=k.length;b<i;b++){c=k[b];if(c.get_id())j.addComponent(c);if(y)j._createdComponents[j._createdComponents.length]=c}}var w=Sys.Application._getCommandProperties(e,d.sysCommand,a,g);if(w){var A=Sys.Application._getCommandProperties(e,d.sysCommandArgument,a,g),z=Sys.Application._getCommandProperties(e,d.sysCommandTarget,a,g);Sys.UI.DomEvent.addHandler(a,"click",Sys.UI.Template._getCommandHandler(w,A,z))}};Sys.Application._getCommandProperties=function(d,b,c,e){var a=null;try{a=d?c[b]:c.getAttribute(b)}catch(f){}return a?Sys.Application._getPropertyValue(null,null,a,e,null,true):null};Sys.Application._splitAttribute=function(c){var a=c.split(":"),b=a.length>1?a[0]:null,d=a[b?1:0];return {ns:b,name:d}};Sys.Application._getBodyNamespaceMapping=function(){if(Sys.Application._bodyNamespaceMapping)return Sys.Application._bodyNamespaceMapping;var a={sysNamespace:"sys",types:"sys:attach",sysId:"sys:id",sysKey:"sys:key",sysActivate:"sys:activate",sysChecked:"sys:checked",styleNamespace:"style",classNamespace:"class",namespaces:{},sysCommandArgument:"sys:commandargument",sysCommand:"sys:command",sysCommandTarget:"sys:commandtarget",codeNamespace:"code",codeIf:"code:if",codeBefore:"code:before",codeAfter:"code:after"};Sys.Application._getNamespaceMapping(a,document.body);Sys.Application._bodyNamespaceMapping=a;return a};Sys.Application._getNamespaceMappings=function(d,c){var b=d||Sys.Application._getBodyNamespaceMapping();for(var a=0,e=c.length;a<e;a++)Sys.Application._getNamespaceMapping(b,c[a]);return b};Sys.Application._getNamespaceMapping=function(namespaceMapping,element){var attributes=element.attributes;for(var i=0,l=attributes.length;i<l;i++){var attribute=attributes[i];if(!attribute.specified)continue;var attrib=Sys.Application._splitAttribute(attribute.nodeName);if(attrib.ns!=="xmlns")continue;var name=attrib.name,value=attribute.nodeValue.trim();if(value.toLowerCase().startsWith("javascript:")){value=value.substr(11).trimStart();if(value==="Sys")with(namespaceMapping){sysNamespace=name;types=name+":attach";sysId=name+":id";sysChecked=name+":checked";sysActivate=name+":activate";sysKey=name+":key";sysCommandArgument=name+":commandargument";sysCommand=name+":command";sysCommandTarget=name+":commandtarget"}else namespaceMapping.namespaces[name]=Type.parse(value)}else if(value==="http://schemas.microsoft.com/aspnet/style")namespaceMapping.styleNamespace=name;else if(value==="http://schemas.microsoft.com/aspnet/class")namespaceMapping.classNamespace=name;else if(value==="http://schemas.microsoft.com/aspnet/code")with(namespaceMapping){codeNamespace=name;codeIf=name+":if";codeBefore=name+":before";codeAfter=name+":after"}}};Sys.Application._getExtensionCode=function(b,l,k){b=b.trim();var e,a,j={},g=b.indexOf(" ");if(g!==-1){e=b.substr(0,g);a=b.substr(g+1);if(a){a=a.replace(/\\,/g,"\x00").split(",");for(var i=0,m=a.length;i<m;i++){var d=a[i].replace(/\u0000/g,","),f=d.indexOf("="),c,h;if(f!==-1){h=d.substr(0,f).trim();c=d.substr(f+1).trim();if(l)c=this._getPropertyValue(null,null,c,k,true)}else{h="$default";c=d.trim()}j[h]=c}}}else e=b;return {instance:Sys.Application._getMarkupExtension(e),name:e,properties:j}};Sys.Application._getPropertyValue=function(g,h,a,d,f,e){var b=a;if(a.startsWith("{{")&&a.endsWith("}}"))b=this._evaluateExpression(a.slice(2,-2),d);else if(!e&&!f&&a.startsWith("{")&&a.endsWith("}")){var c=this._getExtensionCode(a.slice(1,-1),true,d);b=c.instance.extension(g,h,c.properties)}return b};Sys.Application._setProperty=function(c,g,f,a,e){var b=Sys.Application._translateName(f,g),d=b.name;a=Sys.Application._getPropertyValue(c,d,a,e);if(typeof a==="undefined")return;if(b.type===1)b.setter.call(c,a);else if(b.type===2)b.setter.call(c,typeof a==="function"?a:new Function("sender","args",a));else c[d]=a};Sys.Application._tryName=function(a,f){var c=f.prototype,b="set_"+a,d=c[b];if(d)return {name:a,setterName:b,setter:d,type:1};if(a.startsWith("on")){b="add_"+a.substr(2);var e=c[b];if(e)return {name:a,setterName:b,setter:e,type:2}}if(typeof c[a]!=="undefined")return {name:a};return null};Sys.Application._translateName=function(b,c){var a,d=Sys.Application._prototypeIndex[c.__typeName];if(d){a=d[b];if(a)return a}else d={};c.resolveInheritance();a=Sys.Application._tryName(b,c);if(!a){var e=Sys.Application._mapToPrototype(b,c);if(e&&e!==b)a=Sys.Application._tryName(e,c);if(!a)a={name:b}}d[b]=a;return a};Sys.Application._mapToPrototype=function(d,e){var c,b=Sys.Application._caseIndex[e.__typeName];if(!b){b={};e.resolveInheritance();for(var a in e.prototype){if(a.startsWith("get_")||a.startsWith("set_")||a.startsWith("add_"))a=a.substr(4);else if(a.startsWith("remove_"))a=a.substr(7);b[a.toLowerCase()]=a}Sys.Application._caseIndex[e.__typeName]=b}d=d.toLowerCase();if(d.startsWith("on")){c=b[d.substr(2)];if(c)c="on"+c;else c=b[d]}else c=b[d];return c};Sys.Application._doEval=function($expression,$context){with($context.localContext)with($context.userContext||{})return eval("("+$expression+")")};Sys.Application._evaluateExpression=function(b,a){return Sys.Application._doEval.call(a.userContext,b,a)};Sys.Application._activateOnPartial=function(d,g){var a=Sys.Application._activateList;this._updatePanelOld(d,g);if(a&&a.length){var c,f=d.id?Array.indexOf(a,d.id):-1;if(f===-1&&(a.length>1||a[0]!=="*")){var b=d;do{b=b.parentNode;if(b&&b.id){f=Array.indexOf(a,b.id);if(f!==-1){c=b;break}}}while(b)}else c=d;if(c||Array.contains(a,"*")){var e;if(!c||c===document.body)e=Sys.Application._getBodyNamespaceMapping();else e=Sys.Application._getNamespaceMappings(null,[c]);Sys.Application._activateElements(d.childNodes,null,e,{localContext:{}},true)}}};Sys.Application._activateDOM=function(){var g=Sys.Application._getBodyNamespaceMapping(),a=document.body.getAttribute(g.sysActivate),f=Sys.Application._activateList;a=a?a.split(","):[];if(f)Array.addRange(a,f);Sys.Application._activateList=a;if(!a.length)return;var e,c=[];for(var b=0,i=a.length;b<i;b++){a[b]=e=a[b].trim();if(e==="*")c.push(document.body);else{var h=document.getElementById(e);c.push(h)}}Sys.Application._activateElements(c,a);if(Sys.WebForms&&Sys.WebForms.PageRequestManager){Sys.Application._activateList=a;var d=Sys.WebForms.PageRequestManager.getInstance();d._updatePanelOld=d._updatePanel;d._updatePanel=Sys.Application._activateOnPartial}};Sys.Application._registerComponent=function(b,c){var a=b._components;if(!a)b._components=a=[];a[a.length]=c};Sys.Application._raiseInit=function(){this.beginCreateComponents();var a=this.get_events().getHandler("init");if(a)a(this,Sys.EventArgs.Empty);this._activateDOM();this.endCreateComponents()};Sys.UI.Template=function(a){this._element=a;this._instantiateIn=null;this._instanceId=0};Sys.UI.Template.prototype={get_element:function(){return this._element},dispose:function(){this._element=null;this._instantiateIn=null},_appendTextNode:function(b,a,c){b.push(a+"document.createTextNode("+Sys.Serialization.JavaScriptSerializer.serialize(c)+"));\n")},_appendAttributeSetter:function(k,b,l,e,a,f,g){var i=e.ns,c=e.name,j=!i&&Sys.UI.Template._isRestricted(c);if(j)a="Sys.UI.Template._checkAttribute('"+c+"', "+a+")";switch(e.type){case 1:if(f)b.push("  $component = $element;\n  $element."+c+" = "+a+";\n;");else b.push("  $component = $element;\n  "+a+";\n;");return;case 2:c=Sys.Serialization.JavaScriptSerializer.serialize(c);b.push("  $component = $element;\n    ("+a+") ? Sys.UI.DomElement.addCssClass($element, "+c+") : Sys.UI.DomElement.removeCssClass($element, "+c+");\n");return;case 3:b.push("  __context["+a+"] = $component;\n");return;case 4:b.push("  $component = __componentIndex['"+i+"'];\n");if(f){var d=e.map;if(d.type===1)b.push("  $component."+d.setterName+"("+a+");\n");else if(d.type===2){b.push("  __f = "+a+";\n");b.push("  $component."+d.setterName+'(typeof(__f) === "function" ? __f : new Function("sender", "args", __f));\n')}else b.push("  $component."+d.name+" = "+a+";\n")}else b.push("  "+a+";\n");return;case 5:this["_"+c]=a;return;default:if(f){var h=c.toLowerCase();if(h.startsWith("on"))b.push("  $component = $element;\n  $element."+c+" = new Function("+a+");\n");else if(h==="style")b.push("  $component = $element;\n  $element.style.cssText = "+a+";\n");else if(g)b.push("  $component = $element;\n  if ("+a+") {\n    __e = document.createAttribute('"+c+"');\n    __e.nodeValue = \""+g+'";\n    $element.setAttributeNode(__e);\n  }\n');else b.push("  $component = $element;\n  __e = document.createAttribute('"+c+"');\n  __e.nodeValue = "+a+";\n  $element.setAttributeNode(__e);\n")}else b.push("  $component = $element;\n  "+a+";\n");return}},_translateStyleName:function(b){if(b.indexOf("-")===-1)return b;var a=b.toLowerCase().split("-"),d=a[0];for(var c=1,f=a.length;c<f;c++){var e=a[c];d+=e.substr(0,1).toUpperCase()+e.substr(1)}return d},_processAttribute:function(c,f,e,b,a,d){a=this._getAttributeExpression(b,a);if(a)this._appendAttributeSetter(c,f,e,b,a.code,a.isExpression,d)},_getAttributeExpression:function(c,a,j){var i=typeof a;if(i==="undefined")return null;if(a===null)return {isExpression:true,code:"null"};if(i==="string")if(a.startsWith("{{")&&a.endsWith("}}"))return {isExpression:true,code:a.slice(2,-2).trim()};else if(a.startsWith("{")&&a.endsWith("}")){var f=Sys.Serialization.JavaScriptSerializer,e=Sys.Application._getExtensionCode(a.slice(1,-1)),g=e.properties,h="";for(var d in g){var b=this._getAttributeExpression(c,g[d]);if(b&&b.isExpression)h+=","+f.serialize(d)+":"+b.code}return {isExpression:e.instance.expression,code:"__app._getMarkupExtension("+f.serialize(e.name)+").extension($component, "+(c.type===2?"class:":"")+f.serialize(c.name)+", {$dataItem:$dataItem,$index:$index,$id:$id"+h+"})"}}return {isExpression:true,code:j?a:Sys.Serialization.JavaScriptSerializer.serialize(a)}},_processBooleanAttribute:function(d,e,g,f,b){var a,c=d.getAttributeNode(e.sysNamespace+":"+b);if(!c){c=d.getAttributeNode(b);if(c&&(c.specified||c.nodeValue===true))a=true;else if(d.getAttribute(b)===b)a=true;else return}else{a=c.nodeValue;if(a==="true")a=true;else if(a==="false")return}this._processAttribute(e,g,f,{name:b},a,b)},_processBooleanAttributes:function(e,c,f,d,b){var i,j,h;for(var a=0,g=b.length;a<g;a++)this._processBooleanAttribute(e,c,f,d,b[a])},_processCodeBlock:function(a,e,f,d){var b=this._getExplicitAttribute(null,null,null,e,a);if(b){var c=this._getAttributeExpression({name:a},b,true).code;f.push(a===d.codeIf?"  if ("+c+") {\n":"  "+c+"\n");return true}return false},_getExplicitAttribute:function(e,h,f,c,d,b){var a;try{a=c.getAttributeNode(d)}catch(i){return null}if(!a||!a.specified)return null;if(b){var g=d==="style"?c.style.cssText:a.nodeValue;this._processAttribute(e,h,f,{name:b},g)}return a.nodeValue},_buildTemplateCode:function(B,b,E,a,K){var z,g,L,r,h,v,H=Sys.UI.Template._expressionRegExp,k="  "+(K?"__p[__d-1].appendChild(":"__topElements.push(");a.push("  __d++;\n");for(z=0,L=E.childNodes.length;z<L;z++){var c=E.childNodes[z],l=c.nodeValue;if(c.nodeType===8)a.push(k+"document.createComment("+Sys.Serialization.JavaScriptSerializer.serialize(l)+"));\n");else if(c.nodeType===3){var u=l.trim();if(u.startsWith("{")&&u.endsWith("}")&&(!u.startsWith("{{")||!u.endsWith("}}"))){var D,A;if(E.tagName.toLowerCase()==="textarea"){D="value";A="$component=$element;\n"}else{D="nodeValue";A=k+'$element=$component=document.createTextNode(""));\n'}var G=this._getAttributeExpression({name:D},u);if(G.isExpression)a.push(k+"document.createTextNode("+G.code+"));\n");else a.push(A+"  "+G.code+";\n")}else{var p=H.exec(l),w=0;while(p){var I=l.substring(w,p.index);if(I)this._appendTextNode(a,k,I);a.push(k+"document.createTextNode("+p[1]+"));\n");w=p.index+p[0].length;p=H.exec(l)}if(w<l.length)this._appendTextNode(a,k,l.substr(w))}}else{var J=c.attributes,o=null,m=null,e={},x=c.tagName.toLowerCase(),s,T=K+1;if(x==="script")continue;var N=this._processCodeBlock(b.codeIf,c,a,b);this._processCodeBlock(b.codeBefore,c,a,b);v=x==="input";if(v){var Q=this._getAttributeExpression({name:"type"},c.getAttribute("type")),O=this._getAttributeExpression({name:"name"},c.getAttribute("name"));a.push("  $element=__p[__d]=Sys.UI.Template._createInput("+Q.code+", "+O.code+");\n");s=Sys.UI.Template._inputBooleanAttributes;this._processBooleanAttributes(c,b,a,e,s)}else a.push("  $element=__p[__d]=document.createElement('"+c.nodeName+"');\n");o=this._getExplicitAttribute(b,a,e,c,b.types);if(o){o=o.split(",");a.push("  __componentIndex = {}\n");for(g=0,r=o.length;g<r;g++){h=o[g].trim();if(e[h])continue;var q=b.namespaces[h],C=q.inheritsFrom(Sys.Component),M=C&&(q.inheritsFrom(Sys.UI.Behavior)||q.inheritsFrom(Sys.UI.Control)),R=q.implementsInterface(Sys.UI.ITemplateContextConsumer);e[h]={type:q,isComponent:C};a.push("  __components.push(__componentIndex['"+h+"'] = $component = new "+q.getName());if(M)a.push("($element));\n");else a.push("());\n  Sys.Application._registerComponent($element, $component);\n");m=this._getExplicitAttribute(b,a,e,c,h+":sys-key");if(m)this._processAttribute(b,a,e,{ns:h,name:"sys-key",type:3},m);if(C)a.push("  $component.beginUpdate();\n");if(R)a.push("  $component.set_templateContext(__tc);\n")}}m=this._getExplicitAttribute(b,a,e,c,b.sysKey);if(m)a.push("  __context["+Sys.Serialization.JavaScriptSerializer.serialize(m)+"] = $element;\n");this._getExplicitAttribute(b,a,e,c,b.sysId,"id");this._getExplicitAttribute(b,a,e,c,"style","style");this._getExplicitAttribute(b,a,e,c,"class","class");if(!v){s=Sys.UI.Template._booleanAttributes[x]||Sys.UI.Template._commonBooleanAttributes;this._processBooleanAttributes(c,b,a,e,s)}var S=x==="select",j=null;for(g=0,r=J.length;g<r;g++){var n=J[g],f=n.nodeName,t=f.toLowerCase();if(!n.specified&&(!v||t!=="value"))continue;if(t==="class"||t==="style")continue;if(Array.indexOf(s,t)!==-1)continue;if(v&&Array.indexOf(Sys.UI.Template._inputRequiredAttributes,t)!==-1)continue;var d=Sys.Application._splitAttribute(f),i=d.ns,F=n.nodeValue;f=d.name;if(S&&(!i||i===b.sysNamespace)){if(f.toLowerCase()==="selectedindex"){d.type=1;d.name="selectedIndex"}else if(f==="value")d.type=1;if(d.type===1){if(!j)j=[[d,F]];else j[j.length]=[d,F];continue}}if(i){if(i===b.codeNamespace)continue;if(i===b.sysNamespace){if(Array.indexOf(Sys.UI.Template._sysAttributes,f)!==-1)continue;if(f==="command"||f==="commandargument"||f==="commandtarget")d.type=5;d.ns=null}else if(i===b.styleNamespace){d.name="style."+this._translateStyleName(f);d.ns=null;d.type=1}else if(i===b.classNamespace)d.type=2;else{var y=e[i];if(y)if(f==="sys-key")continue;else{d.type=4;d.map=Sys.Application._translateName(d.name,y.type);d.name=d.map.name}else{d.name=i+":"+f;d.ns=null}}}this._processAttribute(b,a,e,d,F)}if(this._command){if(!this._commandargument)this._commandargument="null";if(!this._commandtarget)this._commandtarget="null";a.push(" Sys.UI.DomEvent.addHandler($element, 'click', Sys.UI.Template._getCommandHandler("+this._command+", "+this._commandargument+", "+this._commandtarget+"));\n");this._command=null}this._commandargument=null;this._commandtarget=null;a.push(k+"$element);\n");for(h in e){y=e[h];if(y.isComponent)a.push("  if (($component=__componentIndex['"+h+"']).get_id()) __app.addComponent($component);\nif (__creatingComponents) __app._createdComponents[__app._createdComponents.length] = $component;\n")}if(Sys.UI.Template._isTemplate(c)){var P=new Sys.UI.Template(c);P.compile();B.push(c._msajaxtemplate);a.push("  $element._msajaxtemplate = this.get_element()._msajaxtemplate[1]["+(B.length-1)+"];\n")}else{this._buildTemplateCode(B,b,c,a,T);a.push("  $element=__p[__d];\n")}if(j)for(g=0,r=j.length;g<r;g++){n=j[g];this._processAttribute(b,a,e,n[0],n[1])}this._processCodeBlock(b.codeAfter,c,a,b);if(N)a.push("  }\n")}}a.push("  --__d;\n")},compile:function(){if(!this._instantiateIn){var b=this.get_element();if(b._msajaxtemplate)this._instantiateIn=b._msajaxtemplate[0];else{var a=[" $index = (typeof($index) === 'number' ? $index : __instanceId);\n var __context = {}, $component, __app = Sys.Application, __creatingComponents = __app.get_isCreatingComponents(), __components = [], __componentIndex, __e, __f, __topElements = [], __d = 0, __p = [__containerElement], $id = Sys.UI.Template._getIdFunction($index), $element = __containerElement;\n  var __tc = new Sys.UI.TemplateContext();\n __tc.components = __components;\n __tc.nodes = __topElements;\n __tc.dataItem = $dataItem;\n __tc.index = $index;\n __tc.parentTemplateContext = $parentContext;\n __tc.keys = __context;\n __tc.getInstanceId = $id;\n __tc.containerElement = __containerElement;\n__tc.template = this;\n  Sys.UI.Template._contexts.push(__topElements);\n with(__context) { with($dataItem || {}) {\n"],d=Sys.Application._getNamespaceMappings(null,[b]),c=[];this._buildTemplateCode(c,d,b,a,0);a.push("} }\n  for (var __i = 0, __l = __topElements.length; __i < __l; __i++) {\n  __containerElement.insertBefore(__topElements[__i], __referenceNode);\n }\n");a.push(" Sys.UI.Template._contexts.pop();\n");a.push(" return __tc;");a=a.join("");b._msajaxtemplate=[this._instantiateIn=new Function("__containerElement","$dataItem","$index","__referenceNode","$parentContext","__instanceId",a),c]}}},instantiateIn:function(b,e,d,a,c){b=Sys.UI.DomElement.resolveElement(b);a=a?Sys.UI.DomElement.resolveElement(a):null;this.compile();return this._instantiateIn(b,e,d,a,c,this._instanceId++)}};Sys.UI.Template._isRestricted=function(b){var a=Sys.UI.Template._getRestrictedIndex();return a.attributes[b.toLowerCase()]};Sys.UI.Template._checkAttribute=function(e,a){if(!a)return a;var c=a,b=Sys.UI.Template._getRestrictedIndex();if(b.attributes[e.toLowerCase()]){if(typeof a!=="string")a=a.toString();var d=Sys.UI.Template._protocolRegExp.exec(a.toLowerCase());if(d)if(!b.protocols[d[1]])c=""}return c};Sys.UI.Template._getCommandHandler=function(c,b,a){return function(){if(a){var d=typeof a==="string"?Sys.Application.findComponent(a):a;Sys.UI.DomElement._raiseBubbleEventFromControl(d,this,new Sys.CommandEventArgs(c,b,this))}else Sys.UI.DomElement.raiseBubbleEvent(this,new Sys.CommandEventArgs(c,b,this))}};Sys.UI.Template._getIdFunction=function(a){return function(b){return b+a}};Sys.UI.Template._createInput=function(c,b){var a,e=Sys.UI.Template._dynamicInputs;if(e===true){a=document.createElement("input");if(c)a.type=c;if(b)a.name=b}else{var d="<input ";if(c)d+="type='"+c+"' ";if(b)d+="name='"+b+"' ";d+="/>";try{a=document.createElement(d)}catch(f){Sys.UI.Template._dynamicInputs=true;return Sys.UI.Template._createInput(c,b)}if(e!==false)if(a.tagName.toLowerCase()==="input")Sys.UI.Template._dynamicInputs=false;else{Sys.UI.Template._dynamicInputs=true;return Sys.UI.Template._createInput(c,b)}}return a};Sys.UI.Template._isTemplate=function(b){var a=b.className;return a&&(a==="sys-template"||Array.contains(a.split(" "),"sys-template"))};Sys.UI.Template._contexts=[];Sys.UI.Template._inputRequiredAttributes=["type","name"];Sys.UI.Template._commonBooleanAttributes=["disabled"];Sys.UI.Template._inputBooleanAttributes=["disabled","checked","readonly"];Sys.UI.Template._booleanAttributes={"input":Sys.UI.Template._inputBooleanAttributes,"select":["disabled","multiple"],"option":["disabled","selected"],"img":["disabled","ismap"],"textarea":["disabled","readonly"]};Sys.UI.Template._sysAttributes=["attach","id","key","disabled","checked","readonly","ismap","multiple","selected"];Sys.UI.Template._expressionRegExp=/\{\{\s*([\w\W]*?)\s*\}\}/g;Sys.UI.Template.allowedProtocols=["http","https"];Sys.UI.Template.restrictedAttributes=["src","href","codebase","cite","background","action","longdesc","profile","usemap","classid","data"];Sys.UI.Template._getRestrictedIndex=function(){var b,e,g,f,d=Sys.UI.Template.allowedProtocols||[],c=Sys.UI.Template.restrictedAttributes||[],a=Sys.UI.Template._restrictedIndex;if(!a||a.allowedProtocols!==d||a.restrictedAttributes!==c){a={allowedProtocols:d,restrictedAttributes:c};a.protocols=g={};for(b=0,e=d.length;b<e;b++)g[d[b]]=true;a.attributes=f={};for(b=0,e=c.length;b<e;b++)f[c[b]]=true;Sys.UI.Template._restrictedIndex=a}return a};Sys.UI.Template._protocolRegExp=/^\s*([a-zA-Z0-9\+\-\.]+)\:/;Sys.UI.Template.registerClass("Sys.UI.Template",null,Sys.IDisposable);Sys.UI.TemplateContext=function(){};Sys.UI.TemplateContext.prototype={dataItem:null,index:0,getInstanceId:null,parentTemplateContext:null,containerElement:null,components:null,nodes:null,keys:null,dispose:function(){var a=this.nodes;if(a)for(var b=0,d=a.length;b<d;b++){var c=a[b];if(c.nodeType===1)Sys.Application.disposeElement(c,false)}this.nodes=this.dataItem=this.components=this.getInstanceId=this.containerElement=this.parentTemplateContext=this.keys=null},getElementById:function(e){var f=this.getInstanceId(e),c=this.nodes,a,b,d;for(b=0,d=c.length;b<d;b++){a=c[b];if(a.nodeType!==1)continue;if(a.id===f)return a;a=Sys.UI.DomElement.getElementById(f,a);if(a)return a}for(b=0,d=c.length;b<d;b++){a=c[b];if(a.nodeType!==1)continue;if(a.id===e)return a;a=Sys.UI.DomElement.getElementById(e,a);if(a)return a}return null},getObjectByKey:function(a){if(!this.keys)return null;return this.keys[a]||null},initializeComponents:function(){var b=this.components;if(b)for(var c=b.length-1;c>-1;c--){var a=b[c];if(Sys.Component.isInstanceOfType(a))if(a.get_isUpdating())a.endUpdate();else if(!a.get_isInitialized())a.initialize()}}};Sys.UI.TemplateContext.registerClass("Sys.UI.TemplateContext",null,Sys.IDisposable);Sys.UI.ITemplateContextConsumer=function(){};Sys.UI.ITemplateContextConsumer.prototype={get_templateContext:function(){},set_templateContext:function(){}};Sys.UI.ITemplateContextConsumer.registerInterface("Sys.UI.ITemplateContextConsumer");Sys.CollectionChange=function(e,a,c,b,d){this.action=e;if(a)if(!(a instanceof Array))a=[a];this.newItems=a||null;if(typeof c!=="number")c=-1;this.newStartingIndex=c;if(b)if(!(b instanceof Array))b=[b];this.oldItems=b||null;if(typeof d!=="number")d=-1;this.oldStartingIndex=d};Sys.CollectionChange.registerClass("Sys.CollectionChange");Sys.NotifyCollectionChangedAction=function(){throw Error.notImplemented()};Sys.NotifyCollectionChangedAction.prototype={add:0,remove:1,reset:2};Sys.NotifyCollectionChangedAction.registerEnum("Sys.NotifyCollectionChangedAction");Sys.NotifyCollectionChangedEventArgs=function(a){this._changes=a;Sys.NotifyCollectionChangedEventArgs.initializeBase(this)};Sys.NotifyCollectionChangedEventArgs.prototype={get_changes:function(){return this._changes||[]}};Sys.NotifyCollectionChangedEventArgs.registerClass("Sys.NotifyCollectionChangedEventArgs",Sys.EventArgs);Sys.Observer=function(){};Sys.Observer.registerClass("Sys.Observer");Sys.Observer.makeObservable=function(a){var c=a instanceof Array,b=Sys.Observer;if(a.setValue===b._observeMethods.setValue)return a;b._addMethods(a,b._observeMethods);if(c)b._addMethods(a,b._arrayMethods);return a};Sys.Observer._addMethods=function(c,b){for(var a in b)c[a]=b[a]};Sys.Observer._addEventHandler=function(c,a,b){Sys.Observer._getContext(c,true).events.addHandler(a,b)};Sys.Observer.addEventHandler=function(c,a,b){Sys.Observer._addEventHandler(c,a,b)};Sys.Observer._removeEventHandler=function(c,a,b){Sys.Observer._getContext(c,true).events.removeHandler(a,b)};Sys.Observer.removeEventHandler=function(c,a,b){Sys.Observer._removeEventHandler(c,a,b)};Sys.Observer._raiseEvent=function(b,e,d){var c=Sys.Observer._getContext(b);if(!c)return;var a=c.events.getHandler(e);if(a)a(b,d)};Sys.Observer.raiseEvent=function(c,b,a){Sys.Observer._raiseEvent(c,b,a)};Sys.Observer.addPropertyChanged=function(b,a){Sys.Observer._addEventHandler(b,"propertyChanged",a)};Sys.Observer.removePropertyChanged=function(b,a){Sys.Observer._removeEventHandler(b,"propertyChanged",a)};Sys.Observer._beginUpdate=function(a){Sys.Observer._getContext(a,true).updating=true};Sys.Observer.beginUpdate=function(a){Sys.Observer._beginUpdate(a)};Sys.Observer._endUpdate=function(b){var a=Sys.Observer._getContext(b);if(!a||!a.updating)return;a.updating=false;var d=a.dirty;a.dirty=false;if(d){if(b instanceof Array){var c=a.changes;a.changes=null;Sys.Observer.raiseCollectionChanged(b,c)}Sys.Observer.raisePropertyChanged(b,"")}};Sys.Observer.endUpdate=function(a){Sys.Observer._endUpdate(a)};Sys.Observer._isUpdating=function(b){var a=Sys.Observer._getContext(b);return a?a.updating:false};Sys.Observer.isUpdating=function(a){return Sys.Observer._isUpdating(a)};Sys.Observer._setValue=function(a,j,g){var b,f,k=a,d=j.split(".");for(var i=0,m=d.length-1;i<m;i++){var l=d[i];b=a["get_"+l];if(typeof b==="function")a=b.call(a);else a=a[l];var n=typeof a;if(a===null||n==="undefined")throw Error.invalidOperation(String.format(Sys.UI.TemplatesRes.nullReferenceInPath,j))}var e,c=d[m];b=a["get_"+c];f=a["set_"+c];if(typeof b==="function")e=b.call(a);else e=a[c];if(typeof f==="function")f.call(a,g);else a[c]=g;if(e!==g){var h=Sys.Observer._getContext(k);if(h&&h.updating){h.dirty=true;return}Sys.Observer.raisePropertyChanged(k,d[0])}};Sys.Observer.setValue=function(b,a,c){Sys.Observer._setValue(b,a,c)};Sys.Observer.raisePropertyChanged=function(b,a){Sys.Observer._raiseEvent(b,"propertyChanged",new Sys.PropertyChangedEventArgs(a))};Sys.Observer.addCollectionChanged=function(b,a){Sys.Observer._addEventHandler(b,"collectionChanged",a)};Sys.Observer.removeCollectionChanged=function(b,a){Sys.Observer._removeEventHandler(b,"collectionChanged",a)};Sys.Observer._collectionChange=function(d,c){var a=Sys.Observer._getContext(d);if(a&&a.updating){a.dirty=true;var b=a.changes;if(!b)a.changes=b=[c];else b.push(c)}else{Sys.Observer.raiseCollectionChanged(d,[c]);Sys.Observer.raisePropertyChanged(d,"length")}};Sys.Observer._add=function(a,b){var c=new Sys.CollectionChange(Sys.NotifyCollectionChangedAction.add,[b],a.length);Array.add(a,b);Sys.Observer._collectionChange(a,c)};Sys.Observer.add=function(a,b){Sys.Observer._add(a,b)};Sys.Observer._addRange=function(a,b){var c=new Sys.CollectionChange(Sys.NotifyCollectionChangedAction.add,b,a.length);Array.addRange(a,b);Sys.Observer._collectionChange(a,c)};Sys.Observer.addRange=function(a,b){Sys.Observer._addRange(a,b)};Sys.Observer._clear=function(a){var b=Array.clone(a);Array.clear(a);Sys.Observer._collectionChange(a,new Sys.CollectionChange(Sys.NotifyCollectionChangedAction.reset,null,-1,b,0))};Sys.Observer.clear=function(a){Sys.Observer._clear(a)};Sys.Observer._insert=function(a,b,c){Array.insert(a,b,c);Sys.Observer._collectionChange(a,new Sys.CollectionChange(Sys.NotifyCollectionChangedAction.add,[c],b))};Sys.Observer.insert=function(a,b,c){Sys.Observer._insert(a,b,c)};Sys.Observer._remove=function(a,b){var c=Array.indexOf(a,b);if(c!==-1){Array.remove(a,b);Sys.Observer._collectionChange(a,new Sys.CollectionChange(Sys.NotifyCollectionChangedAction.remove,null,-1,[b],c));return true}return false};Sys.Observer.remove=function(a,b){return Sys.Observer._remove(a,b)};Sys.Observer._removeAt=function(b,a){if(a>-1&&a<b.length){var c=b[a];Array.removeAt(b,a);Sys.Observer._collectionChange(b,new Sys.CollectionChange(Sys.NotifyCollectionChangedAction.remove,null,-1,[c],a))}};Sys.Observer.removeAt=function(a,b){Sys.Observer._removeAt(a,b)};Sys.Observer.raiseCollectionChanged=function(b,a){Sys.Observer._raiseEvent(b,"collectionChanged",new Sys.NotifyCollectionChangedEventArgs(a))};Sys.Observer._observeMethods={add_propertyChanged:function(a){Sys.Observer._addEventHandler(this,"propertyChanged",a)},remove_propertyChanged:function(a){Sys.Observer._removeEventHandler(this,"propertyChanged",a)},addEventHandler:function(a,b){Sys.Observer._addEventHandler(this,a,b)},removeEventHandler:function(a,b){Sys.Observer._removeEventHandler(this,a,b)},get_isUpdating:function(){return Sys.Observer._isUpdating(this)},beginUpdate:function(){Sys.Observer._beginUpdate(this)},endUpdate:function(){Sys.Observer._endUpdate(this)},setValue:function(b,a){Sys.Observer._setValue(this,b,a)},raiseEvent:function(b,a){Sys.Observer._raiseEvent(this,b,a)},raisePropertyChanged:function(a){Sys.Observer._raiseEvent(this,"propertyChanged",new Sys.PropertyChangedEventArgs(a))}};Sys.Observer._arrayMethods={add_collectionChanged:function(a){Sys.Observer._addEventHandler(this,"collectionChanged",a)},remove_collectionChanged:function(a){Sys.Observer._removeEventHandler(this,"collectionChanged",a)},add:function(a){Sys.Observer._add(this,a)},addRange:function(a){Sys.Observer._addRange(this,a)},clear:function(){Sys.Observer._clear(this)},insert:function(a,b){Sys.Observer._insert(this,a,b)},remove:function(a){return Sys.Observer._remove(this,a)},removeAt:function(a){Sys.Observer._removeAt(this,a)},raiseCollectionChanged:function(a){Sys.Observer._raiseEvent(this,"collectionChanged",new Sys.NotifyCollectionChangedEventArgs(a))}};Sys.Observer._getContext=function(b,c){var a=b._observerContext;if(a)return a();if(c)return (b._observerContext=Sys.Observer._createContext())();return null};Sys.Observer._createContext=function(){var a={events:new Sys.EventHandlerList};return function(){return a}};Sys.BindingMode=function(){};Sys.BindingMode.prototype={auto:0,oneTime:1,oneWay:2,twoWay:3,oneWayToSource:4};Sys.BindingMode.registerEnum("Sys.BindingMode");Sys.Binding=function(){Sys.Binding.initializeBase(this)};Sys.Binding.prototype={_convert:null,_convertBack:null,_convertFn:null,_convertBackFn:null,_handlers:null,_ignoreErrors:false,_mode:Sys.BindingMode.auto,_path:null,_targetProperty:null,_source:null,_target:null,_updateSource:false,_updateTarget:false,_defaultValue:null,get_convert:function(){return this._convert||null},set_convert:function(a){this._convert=a;this._convertFn=this._resolveFunction(a)},get_convertBack:function(){return this._convertBack||null},set_convertBack:function(a){this._convertBack=a;this._convertBackFn=this._resolveFunction(a)},get_ignoreErrors:function(){return this._ignoreErrors},set_ignoreErrors:function(a){this._ignoreErrors=a},get_mode:function(){return this._mode},set_mode:function(a){this._mode=a},get_defaultValue:function(){return this._defaultValue},set_defaultValue:function(a){this._defaultValue=a},get_source:function(){return this._source||null},set_source:function(a){this._source=a},get_path:function(){return this._path||""},set_path:function(a){this._path=a;this._pathArray=a?a.split("."):null},get_target:function(){return this._target||null},set_target:function(a){this._target=a},get_targetProperty:function(){return this._targetProperty||""},set_targetProperty:function(a){this._targetProperty=a;this._targetPropertyArray=a?a.split("."):null},_addBinding:function(a){if(a.nodeType===3){a=a.parentNode;if(!a)return}var b=a._msajaxBindings;if(!b)a._msajaxBindings=[this];else b.push(this);if(typeof a.dispose!=="function")a.dispose=Sys.Binding._disposeBindings},_disposeHandlers:function(){for(var c=0,d=this._handlers.length;c<d;c++){var a=this._handlers[c],b=a[2];switch(a[0]){case "click":case "keyup":case "change":Sys.UI.DomEvent.removeHandler(b,a[0],a[1]);break;case "propertyChanged":if(b.remove_propertyChanged)b.remove_propertyChanged(a[1]);else Sys.Observer.removePropertyChanged(b,a[1]);break;case "disposing":b.remove_disposing(a[1])}}},dispose:function(){this._disposed=true;if(this._handlers){this._disposeHandlers();delete this._handlers}this._convert=null;this._convertBack=null;this._convertFn=null;this._convertBackFn=null;this._lastSource=null;this._lastTarget=null;this._source=null;this._target=null;this._pathArray=null;this._defaultValue=null;this._targetPropertyArray=null;Sys.Binding.callBaseMethod(this,"dispose")},_getDefaultMode:function(a){if(Sys.UI.DomElement.isDomElement(a)){if(a.nodeType===1){var b=a.tagName?a.tagName.toLowerCase():null;if(b==="input"||b==="select"||b==="textarea")return Sys.BindingMode.twoWay}}else if(Sys.INotifyPropertyChange.isImplementedBy(a))return Sys.BindingMode.twoWay;return Sys.BindingMode.oneWay},_getPropertyFromIndex:function(a,d,c){for(var b=0;b<=c;b++){if(a===null||typeof a==="undefined")return null;a=this._getPropertyData(a,d[b])}return a},_getPropertyData:function(b,a){if(typeof b["get_"+a]==="function")return b["get_"+a]();else return b[a]},_hookEvent:function(a,c,e){var f;if(Sys.UI.DomElement.isDomElement(a)){thisHandler=Function.createDelegate(this,c);Array.add(this._handlers,["propertyChanged",thisHandler,a]);if(a.add_propertyChanged)a.add_propertyChanged(thisHandler);else Sys.Observer.addPropertyChanged(a,thisHandler);var b=a.tagName?a.tagName.toLowerCase():null;if(b==="input"||b==="select"||b==="textarea"){var d=a.type;if(b==="input"&&d&&(d.toLowerCase()==="checkbox"||d.toLowerCase()==="radio")){thisHandler=Function.createDelegate(this,c);Array.add(this._handlers,["click",thisHandler,a]);Sys.UI.DomEvent.addHandler(a,"click",thisHandler)}if(b==="select"){thisHandler=Function.createDelegate(this,c);Array.add(this._handlers,["click",thisHandler,a]);Sys.UI.DomEvent.addHandler(a,"click",thisHandler)}if(b==="select"){thisHandler=Function.createDelegate(this,c);Array.add(this._handlers,["keyup",thisHandler,a]);Sys.UI.DomEvent.addHandler(a,"keyup",thisHandler)}thisHandler=Function.createDelegate(this,c);Array.add(this._handlers,["change",thisHandler,a]);Sys.UI.DomEvent.addHandler(a,"change",thisHandler);this._addBinding(a)}}else{thisHandler=Function.createDelegate(this,e);Array.add(this._handlers,["propertyChanged",thisHandler,a]);if(a.add_propertyChanged)a.add_propertyChanged(thisHandler);else Sys.Observer.addPropertyChanged(a,thisHandler);if(Sys.INotifyDisposing.isImplementedBy(a)){thisHandler=Function.createDelegate(this,this._onDisposing);Array.add(this._handlers,["disposing",thisHandler,a]);a.add_disposing(thisHandler)}}},_onDisposing:function(){this.dispose()},_resolveFunction:function(a){var b;if(typeof a==="function")b=a;else try{b=Type.parse(a)}catch(c){throw Error.invalidOperation(String.format(Sys.UI.TemplatesRes.functionNotFound,a))}return b},update:function(a){a=a||this.get_mode();if(a===Sys.BindingMode.oneWayToSource)this._onTargetPropertyChanged(true);else this._onSourcePropertyChanged(true)},initialize:function(){var c=this.get_source(),b=this.get_target(),a=this.get_mode();Sys.Binding.callBaseMethod(this,"initialize");if(a===Sys.BindingMode.auto)a=this._getDefaultMode(b);this.update(a);if(a!==Sys.BindingMode.oneTime){this._handlers=[];if(a!==Sys.BindingMode.oneWayToSource)this._hookEvent(c,this._onSourcePropertyChanged,this._onComponentSourceChanged);else if(Sys.UI.DomElement.isDomElement(c))this._addBinding(c);if(a!==Sys.BindingMode.oneWay)this._hookEvent(b,this._onTargetPropertyChanged,this._onComponentTargetChanged);else if(Sys.UI.DomElement.isDomElement(b))this._addBinding(b)}},_onComponentSourceChanged:function(c,b){if(this._disposed)return;var a=b.get_propertyName();if(a===""||a===this._pathArray[0])this._onSourcePropertyChanged()},_onComponentTargetChanged:function(c,b){if(this._disposed)return;var a=b.get_propertyName();if(a===""||a===this._targetPropertyArray[0])this._onTargetPropertyChanged()},_onSourcePropertyChanged:function(f){if(this._disposed)return;var b=this.get_target(),a=this._getPropertyFromIndex(this.get_source(),this._pathArray,this._pathArray.length-1);if(!this._updateSource&&(f||a!==this._lastSource))try{this._updateTarget=true;this._lastSource=this._lastTarget=a;if(this._convertFn)if(this._ignoreErrors)try{a=this._convertFn(a,this)}catch(g){}else a=this._convertFn(a,this);if(a===null||typeof a==="undefined")a=this.get_defaultValue();if(this._targetProperty&&this._targetProperty.startsWith("class:")){var d=this._targetProperty.substr(6).trim();a?Sys.UI.DomElement.addCssClass(b,d):Sys.UI.DomElement.removeCssClass(b,d)}else{var c=this._targetPropertyArray.length;b=this._getPropertyFromIndex(b,this._targetPropertyArray,c-2);if(b!==null&&typeof b!=="undefined"){var e=this._targetPropertyArray[c-1];if(Sys.UI.DomElement.isDomElement(b))a=Sys.UI.Template._checkAttribute(e,a);Sys.Observer.setValue(b,e,a)}}}finally{this._updateTarget=false}},_onTargetPropertyChanged:function(e){if(this._disposed)return;var a=this._getPropertyFromIndex(this.get_target(),this._targetPropertyArray,this._targetPropertyArray.length-1);if(!this._updateTarget&&(e||a!==this._lastTarget))try{this._updateSource=true;this._lastTarget=this._lastSource=a;if(this._convertBackFn)if(this._ignoreErrors)try{a=this._convertBackFn(a,this)}catch(f){}else a=this._convertBackFn(a,this);var c=this._pathArray.length,b=this._getPropertyFromIndex(this.get_source(),this._pathArray,c-2);if(b!==null&&typeof b!=="undefined"){var d=this._pathArray[c-1];if(Sys.UI.DomElement.isDomElement(b))a=Sys.UI.Template._checkAttribute(d,a);Sys.Observer.setValue(b,d,a)}}finally{this._updateSource=false}}};Sys.Binding._disposeBindings=function(){var a=this._msajaxBindings;if(a)for(var b=0,c=a.length;b<c;b++)a[b].dispose();this._msajaxBindings=null;if(this.control&&typeof this.control.dispose==="function")this.control.dispose();if(this.dispose===Sys.Binding._disposeBindings)this.dispose=null};Sys.Binding.registerClass("Sys.Binding",Sys.Component);Sys.Application.registerMarkupExtension("binding",function(f,e,a){var d=a.mode,c=a.ignoreErrors,b=new Sys.Binding;if(d){if(typeof d==="string")d=Sys.BindingMode.parse(d)}else d=Sys.BindingMode.auto;b.set_source(a.source||a.$dataItem);b.set_path(a.path||a.$default);b.set_target(f);b.set_targetProperty(e);b.set_mode(d);if(a.convert)b.set_convert(a.convert);if(a.convertBack)b.set_convertBack(a.convertBack);if(typeof a.defaultValue!=="undefined")b.set_defaultValue(a.defaultValue);if(c){if(typeof c==="string")c=Boolean.parse(c);else c=!!c;b.set_ignoreErrors(c)}b.initialize()},false);Sys.UI.DataView=function(a){Sys.UI.DataView.initializeBase(this,[a])};Sys.UI.DataView.prototype={_autoFetch:false,_fetching:false,_changed:false,_container:null,_currentContainer:null,_currentRef:null,_currentSelectedData:null,_data:null,_dataContext:null,_dataProvider:null,_wsp:null,_wspClass:null,_dirty:false,_stale:true,_dvTemplate:null,_eventType:0,_httpVerb:null,_initialSelectedIndex:-1,_fetchParameters:null,_parentContext:null,_placeholder:null,_query:null,_results:null,_selectedIndex:-1,_selectedItemClass:null,_setData:false,_template:null,_timeout:0,_request:null,_useRemove:false,add_command:function(a){this.get_events().addHandler("command",a)},remove_command:function(a){this.get_events().removeHandler("command",a)},add_dataLoading:function(a){this.get_events().addHandler("dataLoading",a)},remove_dataLoading:function(a){this.get_events().removeHandler("dataLoading",a)},add_itemCreated:function(a){this.get_events().addHandler("itemCreated",a)},remove_itemCreated:function(a){this.get_events().removeHandler("itemCreated",a)},add_fetchFailed:function(a){this.get_events().addHandler("fetchFailed",a)},remove_fetchFailed:function(a){this.get_events().removeHandler("fetchFailed",a)},add_fetchSucceeded:function(a){this.get_events().addHandler("fetchSucceeded",a)},remove_fetchSucceeded:function(a){this.get_events().removeHandler("fetchSucceeded",a)},get_data:function(){return this._data},set_data:function(a){if(!this._setData||this._data!==a)this._loadData(a)},get_dataProvider:function(){return this._provider||null},set_dataProvider:function(a){this._dataContext=this._dataProvider=this._wsp=this._wspClass=null;if(Sys.Data.DataContext.isInstanceOfType(a)){this._dataContext=a;this._dataProvider=a}else if(Sys.Data.IDataProvider.isImplementedBy(a))this._dataProvider=a;else if(Sys.Net.WebServiceProxy.isInstanceOfType(a))this._wsp=a;else if(Type.isClass(a)&&a.inheritsFrom(Sys.Net.WebServiceProxy)&&typeof a.get_path==="function")this._wspClass=a;this._provider=a;if(this.get_autoFetch()&&this._isActive()){if(a)this._doAutoFetch()}else this._stale=true},get_autoFetch:function(){return this._autoFetch},set_autoFetch:function(a){var b=this._autoFetch;if(typeof a==="string")a=Boolean.parse(a);this._autoFetch=a;if(this._isActive()&&this._stale&&!b&&a)this._doAutoFetch()},get_isFetching:function(){return this._fetching},get_httpVerb:function(){return this._httpVerb||"POST"},set_httpVerb:function(a){this._httpVerb=a},get_items:function(){return this._results},get_fetchParameters:function(){return this._fetchParameters},set_fetchParameters:function(a){if(this._fetchParameters!==a){this._fetchParameters=a;if(this.get_autoFetch()&&this._isActive())this._doAutoFetch();else this._stale=true}},get_selectedData:function(){var a=this.get_selectedIndex();if(a>-1){var b=this.get_data();if(b instanceof Array&&a<b.length)return b[a]}return null},get_selectedIndex:function(){return this._selectedIndex},set_selectedIndex:function(a){a=this._validateIndexInput(a);if(!this.get_isInitialized()||!this._setData)this._selectedIndex=a;else this._applySelectedIndex(a)},get_initialSelectedIndex:function(){return this._initialSelectedIndex},set_initialSelectedIndex:function(a){a=this._validateIndexInput(a);if(a!==this.get_initialSelectedIndex()){this._initialSelectedIndex=a;this._raiseChanged("initialSelectedIndex")}},get_selectedItemClass:function(){return this._selectedItemClass||""},set_selectedItemClass:function(a){var c=this.get_selectedItemClass();if(a!==c){var b=this.get_selectedIndex();this._addRemoveCssClass(b,c,Sys.UI.DomElement.removeCssClass);this._addRemoveCssClass(b,a,Sys.UI.DomElement.addCssClass);this._selectedItemClass=a}},get_timeout:function(){return this._timeout},set_timeout:function(a){this._timeout=a},get_fetchOperation:function(){return this._query||""},set_fetchOperation:function(a){if(this._query!==a){this._query=a;if(this.get_autoFetch()&&this._isActive()){if(a)this._doAutoFetch()}else this._stale=true}},get_itemPlaceholder:function(){return this._placeholder||null},set_itemPlaceholder:function(a){if(this._placeholder!==a){this._placeholder=a;this._container=null;this._dirty=true;this._raiseChanged("itemPlaceholder")}},get_templateContext:function(){return this._parentContext||null},set_templateContext:function(a){if(this._parentContext!==a){this._parentContext=a;this._dirty=true;this._raiseChanged("templateContext")}},get_itemTemplate:function(){return this._template||null},set_itemTemplate:function(a){if(this._template!==a){this._template=a;this._dirty=true;if(this._dvTemplate){this._dvTemplate.dispose();this._dvTemplate=null}if(this._isActive()){this.raisePropertyChanged("itemTemplate");if(this._setData)this.refresh()}else this._changed=true}},_applySelectedIndex:function(a,g){var c=this.get_selectedIndex();if(g||a!==c){var b=this.get_data(),b=b instanceof Array?b:[b],f=a<-1||a>(b instanceof Array?b.length-1:-1);this._selectedIndex=a;var e=this._currentSelectedData;this._currentSelectedData=a===-1||f?null:b[a];var d=this.get_selectedItemClass();this._addRemoveCssClass(c,d,Sys.UI.DomElement.removeCssClass);this._addRemoveCssClass(a,d,Sys.UI.DomElement.addCssClass);if(!this.get_isUpdating()){if(a!==c)this.raisePropertyChanged("selectedIndex");if(e!==this._currentSelectedData)this.raisePropertyChanged("selectedData")}else this._changed=true}},_addRemoveCssClass:function(b,e,h){if(e&&b>-1){var c=this.get_items(),g=c?c.length:-1;if(g&&b<g){var a=c[b].nodes;if(a)for(var d=0,i=a.length;d<i;d++){var f=a[d];if(f.nodeType===1)h(f,e)}}}},_clearContainer:function(b,a,c){if(a===0)this._clearElement(b);else this._removeChildren(b,a,c,true)},_clearElement:function(a){Sys.Application.disposeElement(a,true);if(this._useRemove)this._removeChildren(a);else try{a.innerHTML=""}catch(b){this._removeChildren(a);this._useRemove=true}},_collectionChanged:function(l,j){var f=this.get_data(),d=j.get_changes(),a=this.get_selectedIndex(),i=a;if(this._isActive())this.refresh();else{this._dirty=true;return}if(a!==-1&&a<f.length&&f[a]===this._currentSelectedData)return;for(var c=0,k=d.length;c<k;c++){var b=d[c];if(b.action===Sys.NotifyCollectionChangedAction.add){if(a>=b.newStartingIndex)a+=b.newItems.length}else{var e=b.oldStartingIndex,g=b.oldItems.length,h=e+g-1;if(a>h)a-=g;else if(a>=e){a=-1;break}}}if(a!==i)this.set_selectedIndex(a)},_elementContains:function(b,a,c){if(b===a)return !c;do{a=a.parentNode;if(a===b)return true}while(a);return false},_raiseChanged:function(a){if(this._isActive())this.raisePropertyChanged(a);else this._changed=true},_raiseFailed:function(a,c){var b=new Sys.Net.WebRequestEventArgs(a?a.get_executor():null,c);this.onFetchFailed(b);this._raiseEvent("fetchFailed",b)},_raiseSucceeded:function(a,c){var b=new Sys.Net.WebRequestEventArgs(a?a.get_executor():null,null,c);this.onFetchSucceeded(b);this._raiseEvent("fetchSucceeded",b)},_removeChildren:function(a,b,d,c){if(b===0||typeof d==="undefined")while(a.firstChild){if(c)Sys.Application.disposeElement(a.firstChild,false);a.removeChild(a.firstChild)}else while(d--){var e=b?b.previousSibling:a.lastChild;if(c)Sys.Application.disposeElement(e,false);a.removeChild(e)}},_getTemplate:function(){if(this._dvTemplate)return this._dvTemplate;var a=this.get_itemTemplate();if(!a){var b=this.get_element();if(Sys.UI.Template._isTemplate(b))this._dvTemplate=a=new Sys.UI.Template(b)}else if(!Sys.UI.Template.isInstanceOfType(a)){a=Sys.UI.DomElement.resolveElement(a);this._dvTemplate=a=new Sys.UI.Template(a)}return a},_loadData:function(a){var b=new Sys.Data.DataEventArgs(a);this.onDataLoading(b);this._raiseEvent("dataLoading",b);if(b.get_cancel())return false;a=b.get_data();var e=this.get_selectedData();this._swapData(this._data,a);this._data=a;var f=this._setData;this._stale=false;this._dirty=this._setData=true;if(this.get_isInitialized()){var c;if(!f){var d=this.get_selectedIndex();if(d!==-1)this._applySelectedIndex(d,true);else c=this._resetSelectedIndex()}else c=this._resetSelectedIndex();if(!this.get_isUpdating()){this.refresh();this.raisePropertyChanged("data");if(!c&&e!==this.get_selectedData())this.raisePropertyChanged("selectedData");return true}}this._changed=true;return true},_resetSelectedIndex:function(){var c=this.get_data(),a=this.get_initialSelectedIndex(),b=this.get_selectedIndex();if(!(c instanceof Array)||a>=c.length){if(b!==-1){this.set_selectedIndex(-1);return true}}else if(b!==a){this.set_selectedIndex(a);return true}return false},_resolveContainer:function(){if(!this._container){var d,b,a,c=Sys.UI.DomElement.resolveElement(this.get_itemPlaceholder());if(c){a=c.parentNode;b=c.nextSibling}else{a=this.get_element();b=0}this._container=a;this._refNode=b}},_initializeResults:function(){for(var a=0,b=this._results.length;a<b;a++)this._results[a].initializeComponents()},_isActive:function(){return this.get_isInitialized()&&!this.get_isUpdating()},_raiseEvent:function(c,b){var a=this.get_events().getHandler(c);if(a)a(this,b)},_raiseCommand:function(a){this.onCommand(a);this._raiseEvent("command",a)},_raiseItemCreated:function(a){this.onItemCreated(a);this._raiseEvent("itemCreated",a)},abortFetch:function(){if(this._request){this._request.get_executor().abort();this._request=null}if(this._fetching){this._fetching=false;this._raiseChanged("isFetching")}},onBubbleEvent:function(d,a){if(Sys.CommandEventArgs.isInstanceOfType(a)){this._raiseCommand(a);if(a.get_cancel())return true;else{var c=a.get_commandName();if(c&&c.toLowerCase()==="select"){var b=this._getItemIndex(d);if(b!==-1){this.set_selectedIndex(b);return true}}}}return false},onDataLoading:function(){},onFetchFailed:function(){},onFetchSucceeded:function(){},_doAutoFetch:function(){try{if(this._dataProvider||this._provider&&this.get_fetchOperation()){this.fetchData();this._stale=false}}catch(a){this._raiseFailed(null,null)}},_getItemIndex:function(a){if(a&&this._currentContainer){var e=this.get_items();if(e){var b;if(typeof a==="string")b=Sys.UI.DomElement.getElementById(a);else if(Sys.UI.Control.isInstanceOfType(a)||Sys.UI.Behavior.isInstanceOfType(a))b=a.get_element();else if(Sys.UI.DomElement.isDomElement(a))b=a;if(b){var c=b.parentNode,f=this.get_element();while(c&&c!==this._currentContainer&&c!==f){b=c;c=c.parentNode}if(c===this._currentContainer)for(var d=0,g=e.length;d<g;d++)if(Array.contains(e[d].nodes,b))return d}}}return -1},getItem:function(b){var a=this._getItemIndex(b);return a!==-1?this.get_items()[a]:null},refresh:function(){var c=this._getTemplate();if(!c)return;this._dirty=false;this._resolveContainer();var b=this.get_data(),k=this.get_templateContext(),i=this.get_element(),e=this._container,f=this._currentContainer,a;if(f)this._clearContainer(f,this._currentRef,this._currentCount);c.compile();if(f!==this._container){this._useRemove=false;this._clearContainer(e,this._refNode,1)}this._currentContainer=e;this._currentRef=this._refNode;this._currentCount=0;if(c.get_element()===i)Sys.UI.DomElement.removeCssClass(i,"sys-template");if(b===null||typeof b==="undefined")this._results=[];else if(b instanceof Array){var l=b.length;this._results=new Array(l);for(var d=0;d<l;d++){var j=b[d];a=c.instantiateIn(e,j,d,this._currentRef,k);if(this._currentRef!==0)this._currentCount+=a.nodes.length;this._raiseItemCreated(new Sys.UI.DataViewItemEventArgs(j,a));this._results[d]=a}}else{a=c.instantiateIn(e,b,0,this._currentRef,k);if(this._currentRef!==0)this._currentCount=a.nodes.length;this.onItemCreated(new Sys.UI.DataViewItemEventArgs(b,a));this._results=[a]}var g=this.get_selectedItemClass();if(g){var h=this.get_selectedIndex();if(h!==-1)this._addRemoveCssClass(h,g,Sys.UI.DomElement.addCssClass)}this._initializeResults()},_swapData:function(b,a){if(b)switch(this._eventType){case 1:b.remove_collectionChanged(this._changedHandler);break;case 2:Sys.Observer.removeCollectionChanged(b,this._changedHandler)}this._eventType=0;if(a){if(!this._changedHandler)this._changedHandler=Function.createDelegate(this,this._collectionChanged);if(typeof a.add_collectionChanged==="function"){a.add_collectionChanged(this._changedHandler);this._eventType=1}else if(a instanceof Array){Sys.Observer.addCollectionChanged(a,this._changedHandler);this._eventType=2}}},_validateIndexInput:function(a){var b=typeof a;if(b==="string")a=parseInt(a);return a},dispose:function(){if(this._currentContainer&&!Sys.Application.get_isDisposing())this._clearContainer(this._currentContainer,this._currentRef,this._currentCount);if(this._dvTemplate)this._dvTemplate.dispose();if(this.get_isFetching()){this.abortFetch();this._fetching=false}this._swapData(this._data,null);this._currentSelectedData=this._currentContainer=this._currentRef=this._container=this._placeholder=this._results=this._parentContext=this._dvTemplate=this._request=this._dataContext=this._dataProvider=this._wsp=this._wspClass=this._provider=this._data=this._fetchParameters=this._query=null;Sys.UI.DataView.callBaseMethod(this,"dispose")},initialize:function(){Sys.UI.DataView.callBaseMethod(this,"initialize");if(this._setData){var a=this.get_selectedIndex();if(a!==-1)this._applySelectedIndex(a,true);else this._resetSelectedIndex()}if(this._setData)this.refresh();this.updated()},fetchData:function(o,p,j,k){this._stale=false;var b,a=this;function d(c){a._loadData(c);a._fetching=false;a._request=null;a._raiseChanged("isFetching");a._raiseSucceeded(b,c);if(o)o(c,k,"fetchData")}function g(c){a._fetching=false;a._request=null;a._raiseChanged("isFetching");a._raiseFailed(b,c);if(p)p(c,k,"fetchData")}if(this._fetching)this.abortFetch();var q=this._dataProvider,i=this._wsp,n=this._wspClass,h=this.get_fetchOperation(),c=this.get_fetchParameters()||null,e=this.get_httpVerb()||"POST",f=this.get_timeout()||0;if(typeof j==="undefined")j=null;if(q)b=q.fetchData(h,c,j,e,d,g,f,k);else if(i){var l=i.get_path();if(!l){var m=Object.getType(i);if(m&&typeof m.get_path==="function")l=m.get_path()}b=Sys.Data.DataContext._fetchWSP(null,l,h,c,e,d,g,f||i.get_timeout())}else if(n)b=Sys.Data.DataContext._fetchWSP(null,n.get_path(),h,c,e,d,g,f||n.get_timeout());else b=Sys.Data.DataContext._fetchWSP(null,this._provider,h,c,e,d,g,f);this._request=b;this._fetching=true;this._raiseChanged("isFetching");return b},onCommand:function(){},onItemCreated:function(){},updated:function(){if(this._stale&&this.get_autoFetch())this._doAutoFetch();if(this._dirty&&this._setData)this.refresh();if(this._changed){this.raisePropertyChanged("");this._changed=false}}};Sys.UI.DataView.registerClass("Sys.UI.DataView",Sys.UI.Control,Sys.UI.ITemplateContextConsumer);Sys.UI.DataViewItemEventArgs=function(b,a){Sys.UI.DataViewItemEventArgs.initializeBase(this);this._ctx=a||null;this._data=b||null};Sys.UI.DataViewItemEventArgs.prototype={get_dataItem:function(){return this._data},get_templateContext:function(){return this._ctx}};Sys.UI.DataViewItemEventArgs.registerClass("Sys.UI.DataViewItemEventArgs",Sys.EventArgs);
Type.registerNamespace('Sys.UI');Sys.UI.TemplatesRes={'cannotFindMarkupExtension':'A markup extension with the name \'{0}\' could not be found.','requiredIdentity':'The entity must have an identity or a new identity must be creatable with the set getNewIdentityMethod.','nullReferenceInPath':'Null reference while evaluating data path: \'{0}\'.','invalidHandler':'Trying to dispose an invalid handler: \'{0}\'.','entityAlreadyExists':'Entity \'{0}\' already exists and cannot be added again.'};

